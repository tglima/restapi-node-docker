{
	"openapi":"3.1.0",
	"info":{
		"title":"Rest API Manager",
		"description":"{{SWAGGER_INFO_DESCRIPTION_MNG}}",
		"version":"v0.1.0",
		"contact":{
			"name":"API Support",
			"url":"https://github.com/tglima/restapi-node-docker"
		},
		"license":{
			"name":"MIT",
			"url":"https://raw.githubusercontent.com/tglima/restapi-node-docker/main/LICENSE"
		}
	},
	"servers":[
		{
			"url":"/v{{NU_VERSION}}/mng",
			"description":"{{SWAGGER_SERVERS_DESCRIPTION}}"
		}
	],
	"paths":{
		"/log-events/find?code_event={code_event}":{
			"get":{
				"tags":[
					"LogEvent"
				],
				"summary":"Retorna LogEvent através do code_event",
				"operationId":"findLogEventByCodeEvent",
				"security":[
					{
						"API_KEY":[

						],
						"AUTHORIZATION":[

						]
					}
				],
				"parameters":[
					{
						"name":"code_event",
						"in":"query",
						"description":"Código identificador único de cada LogEvent",
						"required":true,
						"schema":{
							"type":"string"
						}
					}
				],
				"responses":{
					"200":{
						"description":"LogEvent encontrados",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/LogEvent"
								}
							}
						}
					},
					"400":{
						"description":"Falha na requisição",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"InvalidRequestResponse":{
										"$ref":"#/components/examples/InvalidRequestResponse"
									}
								}
							}
						}
					},
					"401":{
						"description":"Falha na autenticação",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"InvalidRequestResponse":{
										"$ref":"#/components/examples/AuthFailedResponse"
									}
								}
							}
						}
					},
					"404":{
						"description":"LogEvent não encontrado",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"NotFoundResponse":{
										"$ref":"#/components/examples/NotFoundResponse"
									}
								}
							}
						}
					}
				}
			}
		},
		"/log-events/find?api_key={api_key}&page={page}":{
			"get":{
				"tags":[
					"LogEvent"
				],
				"summary":"Busca um array de LogEvents através do api_key",
				"operationId":"findLogEventByApiKey",
				"security":[
					{
						"API_KEY":[

						],
						"AUTHORIZATION":[

						]
					}
				],
				"parameters":[
					{
						"name":"api_key",
						"in":"query",
						"description":"Chave identificadora de cada usuário na API",
						"required":true,
						"schema":{
							"type":"string"
						}
					},
					{
						"name":"page",
						"in":"query",
						"description":"Referente ao nº da página que deve ser procurado",
						"required":false,
						"schema":{
							"type":"integer",
							"default":1,
							"format":"int32"
						}
					}
				],
				"responses":{
					"200":{
						"description":"LogEvent encontrados",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/PageLogEvents"
								},
								"examples":{
									"PageLogEvents":{
										"$ref":"#/components/examples/PageLogEvents"
									}
								}
							}
						}
					},
					"400":{
						"description":"Falha na requisição",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"InvalidRequestResponse":{
										"$ref":"#/components/examples/InvalidRequestResponse"
									}
								}
							}
						}
					},
					"401":{
						"description":"Falha na autenticação",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"InvalidRequestResponse":{
										"$ref":"#/components/examples/AuthFailedResponse"
									}
								}
							}
						}
					},
					"404":{
						"description":"LogEvent não encontrado",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"NotFoundResponse":{
										"$ref":"#/components/examples/NotFoundResponse"
									}
								}
							}
						}
					}
				}
			}
		},
		"/log-events/find?dt_start={dt_start}&dt_finish={dt_finish}&page={page}":{
			"get":{
				"tags":[
					"LogEvent"
				],
				"summary":"Busca um array de LogEvents através de um intervalo de datas",
				"operationId":"FindLogEventByDateRange",
				"security":[
					{
						"API_KEY":[

						],
						"AUTHORIZATION":[

						]
					}
				],
				"parameters":[
					{
						"name":"dt_start",
						"in":"query",
						"description":"Data de inicio da pesquisa, utilize o formato YYYY-MM-DD HH:mm:ss",
						"required":true,
						"schema":{
							"type":"string"
						}
					},
					{
						"name":"dt_finish",
						"in":"query",
						"description":"Data fim da pesquisa, utilize o formato YYYY-MM-DD HH:mm:ss",
						"required":true,
						"schema":{
							"type":"string"
						}
					},
					{
						"name":"page",
						"in":"query",
						"description":"Referente ao nº da página que deve ser procurado",
						"required":false,
						"schema":{
							"type":"integer",
							"default":1,
							"format":"int32"
						}
					}
				],
				"responses":{
					"200":{
						"description":"LogEvents encontrados",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/PageLogEvents"
								},
								"examples":{
									"PageLogEvents":{
										"$ref":"#/components/examples/PageLogEvents"
									}
								}
							}
						}
					},
					"400":{
						"description":"Falha na requisição",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"InvalidRequestResponse":{
										"$ref":"#/components/examples/InvalidRequestResponse"
									}
								}
							}
						}
					},
					"401":{
						"description":"Falha na autenticação",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"InvalidRequestResponse":{
										"$ref":"#/components/examples/AuthFailedResponse"
									}
								}
							}
						}
					},
					"404":{
						"description":"LogEvent não encontrado",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"NotFoundResponse":{
										"$ref":"#/components/examples/NotFoundResponse"
									}
								}
							}
						}
					}
				}
			}
		},
		"/log-errors/find?id_log_error={id_log_error}":{
			"get":{
				"tags":[
					"LogError"
				],
				"summary":"Retorna LogError através do id informado",
				"operationId":"findLogErrorById",
				"security":[
					{
						"API_KEY":[

						],
						"AUTHORIZATION":[

						]
					}
				],
				"parameters":[
					{
						"name":"id_log_error",
						"in":"query",
						"description":"Id único de cada LogError",
						"required":true,
						"schema":{
							"type":"integer",
							"format":"int32"
						}
					}
				],
				"responses":{
					"200":{
						"description":"LogError encontrado",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/LogError"
								}
							}
						}
					},
					"400":{
						"description":"Falha na requisição",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"InvalidRequestResponse":{
										"$ref":"#/components/examples/InvalidRequestResponse"
									}
								}
							}
						}
					},
					"401":{
						"description":"Falha na autenticação",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"InvalidRequestResponse":{
										"$ref":"#/components/examples/AuthFailedResponse"
									}
								}
							}
						}
					},
					"404":{
						"description":"LogError não encontrado",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"NotFoundResponse":{
										"$ref":"#/components/examples/NotFoundResponse"
									}
								}
							}
						}
					}
				}
			}
		},
		"/log-errors/find?dt_start={dt_start}&dt_finish={dt_finish}&page={page}":{
			"get":{
				"tags":[
					"LogError"
				],
				"summary":"Busca um array de LogError através de um intervalo de datas",
				"operationId":"FindLogErrorByDateRange",
				"security":[
					{
						"API_KEY":[

						],
						"AUTHORIZATION":[

						]
					}
				],
				"parameters":[
					{
						"name":"dt_start",
						"in":"query",
						"description":"Data de inicio da pesquisa, utilize o formato YYYY-MM-DD HH:mm:ss",
						"required":true,
						"schema":{
							"type":"string"
						}
					},
					{
						"name":"dt_finish",
						"in":"query",
						"description":"Data fim da pesquisa, utilize o formato YYYY-MM-DD HH:mm:ss",
						"required":true,
						"schema":{
							"type":"string"
						}
					},
					{
						"name":"page",
						"in":"query",
						"description":"Referente ao nº da página que deve ser procurado",
						"required":false,
						"schema":{
							"type":"integer",
							"default":1,
							"format":"int32"
						}
					}
				],
				"responses":{
					"200":{
						"description":"LogErrors encontrados",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/PageLogErrors"
								},
								"examples":{
									"PageLogEvents":{
										"$ref":"#/components/examples/PageLogErrors"
									}
								}
							}
						}
					},
					"400":{
						"description":"Falha na requisição",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"InvalidRequestResponse":{
										"$ref":"#/components/examples/InvalidRequestResponse"
									}
								}
							}
						}
					},
					"401":{
						"description":"Falha na autenticação",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"InvalidRequestResponse":{
										"$ref":"#/components/examples/AuthFailedResponse"
									}
								}
							}
						}
					},
					"404":{
						"description":"LogError não encontrado",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"NotFoundResponse":{
										"$ref":"#/components/examples/NotFoundResponse"
									}
								}
							}
						}
					}
				}
			}
		},
		"/database-info":{
			"get":{
				"tags":[
					"Database"
				],
				"summary":"Retorna informações relevantes referentes ao banco de dados (Tamanho em mb, nome das tabelas, total de registros, etc)",
				"operationId":"GetDatabaseInfo",
				"security":[
					{
						"API_KEY":[

						],
						"AUTHORIZATION":[

						]
					}
				],
				"parameters":[

				],
				"responses":{
					"200":{
						"description":"Dados relevantes do banco de dados",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DatabaseInfo"
								},
								"examples":{
									"DatabaseInfo":{
										"$ref":"#/components/examples/DatabaseInfo"
									}
								}
							}
						}
					},
					"400":{
						"description":"Falha na requisição",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								}
							}
						}
					},
					"401":{
						"description":"Falha na autenticação",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"InvalidRequestResponse":{
										"$ref":"#/components/examples/AuthFailedResponse"
									}
								}
							}
						}
					}
				}
			}
		},
		"/database-backup":{
			"get":{
				"tags":[
					"Database"
				],
				"summary":"Retorna um zip com um backup do banco de dados",
				"operationId":"GetDatabaseBackup",
				"security":[
					{
						"API_KEY":[

						],
						"AUTHORIZATION":[

						]
					}
				],
				"parameters":[

				],
				"responses":{
					"200":{
						"description":"Arquivo zip para download",
						"content":{
							"application/zip":{
								"schema":{
									"type":"string",
									"format":"binary"
								}
							}
						}
					},
					"400":{
						"description":"Falha na requisição",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"InvalidRequestResponse":{
										"$ref":"#/components/examples/InvalidRequestResponse"
									}
								}
							}
						}
					},
					"401":{
						"description":"Falha na autenticação",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"InvalidRequestResponse":{
										"$ref":"#/components/examples/AuthFailedResponse"
									}
								}
							}
						}
					}
				}
			}
		},
		"/database/delete?table_name={table_name}":{
			"delete":{
				"tags":[
					"Database"
				],
				"summary":"Apaga {{QTD_ITEMS_DELETE}} itens mais antigos da tabela informada",
				"operationId":"DeleteRowsTable",
				"security":[
					{
						"API_KEY":[

						],
						"AUTHORIZATION":[

						]
					}
				],
				"parameters":[
					{
						"name":"table_name",
						"in":"query",
						"description":"Nome da tabela que deve ser feito a exclusão de registros",
						"required":true,
						"explode":true,
						"schema":{
							"type":"string",
							"enum":[
								"log_error",
								"log_event"
							]
						}
					}
				],
				"responses":{
					"200":{
						"description":"Itens apagados",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DeleteResponse"
								},
								"examples":{
									"InvalidRequestResponse":{
										"$ref":"#/components/examples/DeleteResponse"
									}
								}
							}
						}
					},
					"400":{
						"description":"Falha na requisição",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"InvalidRequestResponse":{
										"$ref":"#/components/examples/InvalidRequestResponse"
									}
								}
							}
						}
					},
					"401":{
						"description":"Falha na autenticação",
						"content":{
							"application/json":{
								"schema":{
									"$ref":"#/components/schemas/DefaultResponse"
								},
								"examples":{
									"InvalidRequestResponse":{
										"$ref":"#/components/examples/AuthFailedResponse"
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"components":{
		"schemas":{
			"LogEvent":{
				"type":"object",
				"properties":{
					"id_log_event":{
						"type":"integer"
					},
					"code_event":{
						"type":"string"
					},
					"dt_start":{
						"type":"string",
						"format":"date-time"
					},
					"dt_finish":{
						"type":"string",
						"format":"date-time"
					},
					"type_event":{
						"type":"string"
					},
					"json_log_event":{
						"type":"object"
					}
				}
			},
			"LogError":{
				"type":"object",
				"properties":{
					"id_log_error":{
						"type":"integer"
					},
					"dt_register":{
						"type":"string",
						"format":"date-time"
					},
					"method":{
						"type":"string"
					},
					"json_log_error":{
						"type":"object"
					}
				}
			},
			"DatabaseInfo":{
				"type":"object",
				"properties":{
					"database_name":{
						"type":"string"
					},
					"database_size":{
						"type":"string"
					},
					"tables_name":{
						"type":"array",
						"items":{
							"type":"string"
						}
					},
					"product_total":{
						"type":"integer"
					},
					"log_event_total":{
						"type":"integer"
					},
					"log_error_total":{
						"type":"integer"
					}
				}
			},
			"DatabaseBackup":{
				"type":"object",
				"properties":{
					"file":{
						"type":"string",
						"format":"binary"
					}
				}
			},
			"DeleteResponse":{
				"type":"object",
				"properties":{
					"messages":{
						"type":"array",
						"items":{
							"type":"string"
						}
					}
				}
			},
			"DefaultResponse":{
				"type":"object",
				"properties":{
					"code_event":{
						"type":"string"
					},
					"messages":{
						"type":"array",
						"items":{
							"type":"string"
						}
					}
				}
			},
			"PageLogEvents":{
				"type":"object",
				"properties":{
					"total_items":{
						"type":"integer"
					},
					"total_pages":{
						"type":"integer"
					},
					"current_page":{
						"type":"integer"
					},
					"log_events":{
						"type":"array",
						"items":{
							"$ref":"#/components/schemas/LogEvent"
						}
					}
				}
			},
			"PageLogErrors":{
				"type":"object",
				"properties":{
					"total_items":{
						"type":"integer"
					},
					"total_pages":{
						"type":"integer"
					},
					"current_page":{
						"type":"integer"
					},
					"log_errors":{
						"type":"array",
						"items":{
							"$ref":"#/components/schemas/LogError"
						}
					}
				}
			}
		},
		"examples":{
			"AuthFailedResponse":{
				"value":{
					"code_event":"b000b00a-ab00-0000-b000-bb000b000000",
					"messages":[
						"Credenciais inválidas ou ausentes"
					]
				}
			},
			"InvalidRequestResponse":{
				"value":{
					"code_event":"b000b00a-ab00-0000-b000-bb000b000000",
					"messages":[
						"Ocorreu uma falha/erro na sua requisição. Reveja os dados enviados e tente novamente!"
					]
				}
			},
			"NotFoundResponse":{
				"value":{
					"code_event":"b000b00a-ab00-0000-b000-bb000b000000",
					"messages":[
						"Item não encontrado!"
					]
				}
			},
			"DatabaseInfo":{
				"value":{
					"database_name":"database.db",
					"database_size":"1.5 mb",
					"tables_name":[
						"product",
						"log_event",
						"log_error"
					],
					"product_total":3,
					"log_event_total":30,
					"log_error_total":0
				}
			},
			"PageLogEvents":{
				"value":{
					"total_items":2,
					"total_pages":1,
					"current_page":1,
					"log_events":[
						{
							"id_log_event":1,
							"code_event":"b000b00a-ab00-0000-b000-bb000b000000",
							"dt_start":"2023-11-01 00:00:00",
							"dt_finish":"2023-11-01 00:00:01",
							"type_event":"request",
							"json_log_event":{
								"json_dynamic":"Dinâmico"
							}
						},
						{
							"id_log_event":2,
							"code_event":"b000b00a-ab00-0000-b000-bb000b000000",
							"dt_start":"2023-11-01 00:01:00",
							"dt_finish":"2023-11-01 00:01:01",
							"type_event":"request",
							"json_log_event":{
								"json_dynamic":"Dinâmico"
							}
						}
					]
				}
			},
			"PageLogErrors":{
				"value":{
					"total_items":2,
					"total_pages":1,
					"current_page":1,
					"log_errors":[
						{
							"id_log_error":1,
							"code_event":"b000b00a-ab00-0000-b000-bb000b000000",
							"dt_register":"2023-11-01 00:00:00",
							"method":"exceptionHandler",
							"json_log_error":{
								"json_dynamic":"Dinâmico"
							}
						},
						{
							"id_log_error":2,
							"code_event":"b000b00a-ab00-0000-b000-bb000b000000",
							"dt_register":"2023-11-01 00:01:00",
							"method":"exceptionHandler",
							"json_log_error":{
								"json_dynamic":"Dinâmico"
							}
						}
					]
				}
			},
			"DeleteResponse":{
				"value":{
					"messages":[
						"{{MSG_DATABASE_DELETE_ROWS}}"
					]
				}
			}
		},
		"securitySchemes":{
			"API_KEY":{
				"type":"apiKey",
				"in":"header",
				"name":"API-KEY",
				"description":"Chave de acesso individual disponibilizado para acessar a API"
			},
			"AUTHORIZATION":{
				"type":"apiKey",
				"in":"header",
				"name":"authorization",
				"description":"Chave de acesso disponibilizada apenas para admnistradores da API"
			}
		}
	}
}
